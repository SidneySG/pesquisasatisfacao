(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[48],{250:function(e,t,a){"use strict";var n=a(1),r=a(2),i=a(0),l=(a(6),a(4)),c=a(5),o=i.forwardRef((function(e,t){var a=e.classes,c=e.className,o=Object(r.a)(e,["classes","className"]);return i.createElement("div",Object(n.a)({className:Object(l.a)(a.root,c),ref:t},o))}));o.muiName="ListItemSecondaryAction",t.a=Object(c.a)({root:{position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"}},{name:"MuiListItemSecondaryAction"})(o)},6658:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return H}));var n=a(246),r=a(221),i=a.n(r),l=a(222),c=a(16),o=a(0),u=a.n(o),s=a(11),m=a(104),d=a(188),p=a(146),f=a(190),b=a(250),E=a(193),h=a(213),y=a(53),v=a(208),g=a(101),O=a(206),j=a(209),x=a(212),C=a(330),k=a(331),N=a(446),S=a(6677),w=a(107),A=a(54),W=a(458),D=a.n(W),z=[],L=[],I=[],U=[],B=[],P=[],R={},G="",M=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],J=[{label:"Colunas",value:"colls"},{label:"Barras",value:"bar"},{label:"Linhas",value:"line"},{label:"Pizza",value:"pie"}],T={name:"",title:"",displayName:"",description:""},F=[];function H(e){var t=Object(o.useState)(!1),a=Object(c.a)(t,2),r=a[0],W=a[1],H=Object(o.useState)({changeRoute:!1,to:""}),Y=Object(c.a)(H,2),q=Y[0],K=Y[1],Q=Object(o.useState)({label:"Barras",value:"bar"}),V=Object(c.a)(Q,2),Z=V[0],$=V[1],_=Object(o.useState)([]),ee=Object(c.a)(_,2),te=ee[0],ae=ee[1],ne=Object(o.useState)(!0),re=Object(c.a)(ne,2),ie=re[0],le=re[1],ce=Object(o.useState)(!1),oe=Object(c.a)(ce,2),ue=oe[0],se=oe[1],me=Object(o.useState)(!1),de=Object(c.a)(me,2),pe=de[0],fe=de[1],be=u.a.useState(null),Ee=Object(c.a)(be,2),he=Ee[0],ye=Ee[1],ve=function(e){$(e),ye(null)};function ge(){return(ge=Object(l.a)(i.a.mark((function e(){var t,a,n,l,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Object(A.c)().getAttributeSet(),Object(A.c)().getOrganisationUnits(),Object(A.c)().getDataCleaners()]);case 2:t=e.sent,a=Object(c.a)(t,3),n=a[0],l=a[1],o=a[2],P=n.data,F=o.data,L=l.data,W(!r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(o.useEffect)((function(){z=[],L=[],P=[],F=[],R={},I=[],function(){ge.apply(this,arguments)}()}),[]);var Oe={addAttribute:function(e){I.push(e),W(!r)},removeAttribute:function(e){I=I.filter((function(t){return t!==e})),W(!r)},addOrgUnit:function(e){B.push(e),W(!r)},removeOrgUnit:function(e){B=B.filter((function(t){return t!==e})),W(!r)}},je=function(e,t){return u.a.createElement(m.a,{elevation:0,style:{border:"1px solid #c4c4c4",width:"100%",height:280,overflow:"auto"},square:!0},u.a.createElement(d.a,{dense:!0,component:"div",role:"list"},e.map((function(e,a){return u.a.createElement(p.a,{onDoubleClick:function(){return Oe[t](e.id)},key:a,role:"listitem",button:!0},u.a.createElement(f.a,{primary:e.displayName}),u.a.createElement(b.a,null,u.a.createElement(E.a,{color:"secondary",size:"small",onClick:function(){Oe[t](e.id)}},u.a.createElement(w.f,null))))})),u.a.createElement(p.a,null)))};function xe(){return(xe=Object(l.a)(i.a.mark((function e(){var t,a,n,r,l,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return le(!0),t=[],a=[],R.attributes.forEach((function(e){I.includes(e.id)&&t.push(e.uid)})),L.forEach((function(e){B.includes(e.id)&&a.push(e.uid)})),n=Object.keys(U).map((function(e){return e+"("+U[e]+")"})).join(","),e.next=8,Promise.resolve(Object(A.c)().getAgregatedData(R.uid,t,a,G,n));case 8:r=e.sent,{title:R.displayName},l={},{},r.data.headers.forEach((function(e){l[e.uid]={displayName:e.displayName,attribute:e.attribute}})),c=r.data.headers.map((function(e,t){return{label:e.displayName,name:M[t],value:r.data.values[e.uid]}})),ae({title:R.displayName,attribute:"Rotas",type:Z.value,data:c}),le(!1);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(){return ke.apply(this,arguments)}function ke(){return(ke=Object(l.a)(i.a.mark((function t(){var a,r,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=[],r=[],R.attributes.forEach((function(e){I.includes(e.id)&&a.push(e)})),L.forEach((function(e){B.includes(e.id)&&r.push(e)})),l=Object.keys(U).map((function(e){return e+"("+U[e]+")"})).join(","),T=Object(n.a)({},T,{component:Z.value,attributeSet:R,attributes:a,orgUnits:r,dataCleaners:l}),t.next=8,Promise.resolve(Object(A.c)().postDashboards(T));case 8:e.messageBox("Dashboard criado com exito!"),K({to:"dashboards",changeRoute:!0});case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return q.changeRoute?u.a.createElement(s.a,{to:q.to}):u.a.createElement(h.a,{display:"flex"},u.a.createElement(h.a,{flexGrow:1},u.a.createElement(h.a,{display:"flex"},u.a.createElement(h.a,{flexGrow:1},u.a.createElement(y.a,{variant:"h6",color:"initial"},"Create dashboard element"),u.a.createElement("br",null),u.a.createElement("br",null),!ie&&u.a.createElement(u.a.Fragment,null,u.a.createElement(D.a,{option:X(te,Z.value)}),u.a.createElement("ul",{style:{listStyle:"none"}},te.data.map((function(e,t){return u.a.createElement("li",{key:t},u.a.createElement(y.a,{key:t,variant:"button",style:{textTransform:"none"}},M[t],": ",e.label))}))))),u.a.createElement(h.a,null,u.a.createElement(v.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){ye(e.currentTarget)}},Z.label)," \xa0",u.a.createElement(g.a,{id:"simple-menu",anchorEl:he,keepMounted:!0,open:Boolean(he),onClose:ve},J.map((function(e){return u.a.createElement(O.a,{onClick:function(){return ve(e)}},e.label)}))),u.a.createElement(v.a,{onClick:function(){return xe.apply(this,arguments)},s:!0,variant:"contained",size:"small",color:"primary"},"Actualizar")," \xa0",u.a.createElement(v.a,{onClick:function(){fe(!0)},variant:"contained",size:"small",color:"primary"},"Definic\xf5es")," \xa0",u.a.createElement(v.a,{onClick:function(){se(!0)},variant:"contained",size:"small",color:"primary"},"Salvar")," \xa0"))),u.a.createElement(h.a,{style:{width:"300px",borderLeft:"1px solid #eee",padding:"7px",maxHeight:"calc(100vh - 150px)"}},u.a.createElement(j.a,{container:!0},u.a.createElement(j.a,{item:!0,sm:12},u.a.createElement(S.a,{onChange:function(e,t){z=t.attributes,R=t,W(!r)},getOptionLabel:function(e){return e.displayName},fullWidth:!0,id:"attributeSet",size:"small",options:P,style:{minWidth:200},renderInput:function(e){return u.a.createElement(x.a,Object.assign({variant:"outlined",margin:"dense",fullWidth:!0},e,{label:"Attribute Set"}))}})),u.a.createElement(j.a,{item:!0,sm:12},u.a.createElement(S.a,{onChange:function(e,t){Oe.addAttribute(t.id)},getOptionLabel:function(e){return e.displayName},fullWidth:!0,id:"attributes",size:"small",options:z.filter((function(e){return!I.includes(e.id)})),style:{minWidth:200},renderInput:function(e){return u.a.createElement(x.a,Object.assign({variant:"outlined",margin:"dense",fullWidth:!0},e,{label:"Attribute"}))}})),u.a.createElement(j.a,{item:!0,sm:12},je(I.map((function(e){return z.filter((function(t){return t.id==e}))[0]})),"removeAttribute")),u.a.createElement(j.a,{item:!0,sm:12},u.a.createElement(x.a,{select:!0,onChange:function(e){G=e.target.value},type:"text",variant:"outlined",name:"periodo",margin:"dense",id:"periodo",fullWidth:!0,label:"Periodo"},u.a.createElement(O.a,{value:"general"},"Geral"),u.a.createElement(O.a,{value:"daily"},"Diario"),u.a.createElement(O.a,{value:"weekly"},"Semanal"),u.a.createElement(O.a,{value:"monthly"},"Mensal"),u.a.createElement(O.a,{value:"yearly"},"Anual"))),u.a.createElement(j.a,{item:!0,sm:12},u.a.createElement(S.a,{onChange:function(e,t){Oe.addOrgUnit(t.id)},getOptionLabel:function(e){return e.displayName},fullWidth:!0,id:"instituicao",size:"small",options:L,style:{minWidth:200},renderInput:function(e){return u.a.createElement(x.a,Object.assign({variant:"outlined",margin:"dense",fullWidth:!0},e,{label:"Institui\xe7\xe3o"}))}})),u.a.createElement(j.a,{item:!0,sm:12},je(B.map((function(e){return L.filter((function(t){return t.id==e}))[0]})),"removeOrgUnit"),u.a.createElement("br",null)))),u.a.createElement(C.a,{open:ue,title:"Detalhes do gr\xe1fico"},u.a.createElement(k.a,null,u.a.createElement(j.a,{container:!0},u.a.createElement(j.a,{item:!0,sm:12},u.a.createElement(x.a,{onChange:function(e){T.name=e.target.value},type:"text",variant:"outlined",name:"name",margin:"dense",id:"periodo",fullWidth:!0,label:"Name"})),u.a.createElement(j.a,{item:!0,sm:12},u.a.createElement(x.a,{onChange:function(e){T.displayName=e.target.value},type:"text",variant:"outlined",name:"displayName",margin:"dense",id:"displayName",fullWidth:!0,label:"Display Name"})),u.a.createElement(j.a,{item:!0,sm:12},u.a.createElement(x.a,{multiline:!0,rows:4,onChange:function(e){T.description=e.target.value},type:"text",variant:"outlined",name:"description",margin:"dense",id:"description",fullWidth:!0,label:"Description"})))),u.a.createElement(N.a,{style:{textAlign:"right"}},u.a.createElement(v.a,{onClick:function(){se(!1)},color:"secondary"},"Cancelar"),u.a.createElement(v.a,{onClick:Ce,color:"primary",variant:"contained"},"Salvar"))),u.a.createElement(C.a,{open:pe,title:"Defini\xe7\xf5es"},u.a.createElement(k.a,null,u.a.createElement(j.a,{container:!0},I.map((function(e){return z.filter((function(t){return t.id==e}))[0]})).map((function(e){return u.a.createElement(j.a,{item:!0,sm:12},u.a.createElement(x.a,{select:!0,onChange:function(t){U[e.uid]=t.target.value},type:"text",variant:"outlined",name:"dataCleaner"+e.uid,margin:"dense",id:"dataCleaner"+e.uid,fullWidth:!0,label:e.displayName},F.map((function(e){return u.a.createElement(O.a,{value:e.function},e.label)}))))})))),u.a.createElement(N.a,{style:{textAlign:"right"}},u.a.createElement(v.a,{onClick:function(){fe(!1)},color:"secondary"},"Cancelar"),u.a.createElement(v.a,{onClick:Ce,color:"primary",variant:"contained"},"Salvar"))))}function X(e,t){return Object(n.a)({title:{text:e.title,subtext:"",x:"center"},tooltip:{trigger:"item",formatter:"{b} : {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:10,top:20,bottom:20,data:e.data}},function(e,t){return"bar"==t?{xAxis:{type:"value",boundaryGap:[0,.01]},yAxis:{type:"category",data:e.data.map((function(e){return e.name}))}}:"pie"!==t?{xAxis:{data:e.data.map((function(e){return e.name}))},yAxis:{}}:void 0}(e,t),{series:[{name:e.attribute,type:"colls"==t?"bar":t,center:["50%","60%"],label:{show:!0,position:"bar"==t?"right":"top"},data:e.data,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})}}}]);
//# sourceMappingURL=48.06bb7bd3.chunk.js.map