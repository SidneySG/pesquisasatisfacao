(this["webpackJsonpfrontend.atendimento.co.mz"]=this["webpackJsonpfrontend.atendimento.co.mz"]||[]).push([[30],{1816:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return H}));var n=a(29),i=a.n(n),c=a(28),r=a(51),s=a(16),l=a(0),o=a.n(l),d=a(18),j=a(438),b=a(439),u=a(440),h=a(441),m=a(442),p=a(443),O=a(433),g=a(400),x=a(88),f=a(181),y=a(404),v=a(455),k=a(403),w=a(405),N=a(429),C=a(413),S=a.n(C),_=a(456),M=a(760),z=a.n(M),A=a(761),E=a(71),F=(a(62),a(34)),I=a(2),W={height:"450px",width:"100%"},R={fillColor:"#2196F3",strokeColor:"#2196F3",fillOpacity:.5,strokeOpacity:1,strokeWeight:2,clickable:!1,draggable:!1,editable:!1,geodesic:!1,zIndex:1},U={lat:-25.953724,lng:32.588711},B=null,T=[],J={},L={},P={},D=[],V=[];function G(e,t){var a=e.target.files,n=new FileReader;n.readAsDataURL(a[0]),n.onloadend=function(){P[t]=n.result}}function H(e){var t=Object(d.g)().id,a=Object(l.useState)(!0),n=Object(s.a)(a,2),C=n[0],M=n[1],H=Object(l.useState)([]),Q=Object(s.a)(H,2),X=Q[0],q=Q[1],K=Object(l.useState)(!0),Y=Object(s.a)(K,2),Z=Y[0],$=Y[1],ee=Object(l.useState)(!1),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],ie=Object(l.useState)({coordinates:[]}),ce=Object(s.a)(ie,2),re=ce[0],se=ce[1],le=Object(l.useState)({changeRoute:!1,to:""}),oe=Object(s.a)(le,2),de=oe[0],je=oe[1],be=o.a.useState({drawingMode:"polygon"}),ue=Object(s.a)(be,2),he=(ue[0],ue[1]);function me(e){M(!1),B=e.target.files[0];var t=new FileReader;B=t.readAsText(B),t.onload=function(){var e=JSON.parse(t.result),a=[],n=[];T=e.features[0].geometry.coordinates[0][0].map((function(e){return a.push(e[1]),n.push(e[0]),{lng:e[0],lat:e[1]}}));var i=(Math.min.apply(Math,a)+Math.max.apply(Math,a))/2,c=(Math.min.apply(Math,n)+Math.max.apply(Math,n))/2;U={lat:i,lng:c},J.coordenadas=T,q(T),M(!0)}}Object(l.useEffect)((function(){function e(){return(e=Object(r.a)(i.a.mark((function e(){var a,n,r,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(!0),e.next=3,Promise.all([Object(F.c)().getOrganisationUnits("?id=".concat(atob(t))),Object(F.c)().getUsers()]);case 3:a=e.sent,n=Object(s.a)(a,2),r=n[0],l=n[1],L=r.data[0],D=l.data,se(Object(c.a)(Object(c.a)({},L),{},{coordinates:[]})),ne(!ae),$(!1);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var pe=function(e){};return de.changeRoute?Object(I.jsx)(d.a,{to:de.to}):Z?Object(I.jsx)(O.a,{children:Object(I.jsxs)("div",{class:"loader",children:[Object(I.jsx)("div",{class:"inner one"}),Object(I.jsx)("div",{class:"inner two"}),Object(I.jsx)("div",{class:"inner three"})]})}):Object(I.jsx)("div",{className:z.a.container,children:Object(I.jsx)(O.a,{children:Object(I.jsx)(E.b,{initialValues:re,onSubmit:function(a,n){var c=n.setSubmitting;function s(){return(s=Object(r.a)(i.a.mark((function a(n){return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return Object.keys(P).length>0?Object.keys(P).forEach((function(e){n[e]=P[e]})):(delete n.logo,delete n.bgImage),n.coordinates.length<=0&&X.length>0?n.coordinates=X:n.coordinates.length<=0&&delete n.coordinates,a.next=4,Promise.resolve(Object(F.c)().putOrganisationUnits(JSON.stringify(n),atob(t)));case 4:e.messageBox("Institui\xe7\xe3o actualizada com exito!"),je({to:"/instituicoes",changeRoute:!0});case 6:case"end":return a.stop()}}),a)})))).apply(this,arguments)}!function(e){s.apply(this,arguments)}(a),setTimeout((function(){c(!1)}),500)},children:function(e){var t=e.values,a=e.touched,n=e.errors,i=(e.dirty,e.isSubmitting,e.handleChange),r=e.handleBlur,s=(e.handleSubmit,e.handleReset,e.setFieldValue);return Object(I.jsxs)(E.a,{children:[Object(I.jsxs)(g.a,{container:!0,spacing:2,children:[Object(I.jsx)(g.a,{item:!0,sm:12,children:Object(I.jsx)(x.a,{variant:"h6",style:{color:"#0070c0"},children:"Edi\xe7\xe3o de institui\xe7\xe3o"})}),Object(I.jsx)(g.a,{item:!0,sm:12,children:Object(I.jsx)(w.a,{value:t.name,error:n.name&&a.name,helperText:n.name,name:"name",id:"name",margin:"dense",onChange:i,onBlur:r,variant:"outlined",label:"Name (*)",fullWidth:!0})}),Object(I.jsx)(g.a,{item:!0,sm:12,children:Object(I.jsx)(w.a,{value:t.shortName,error:n.shortName&&a.shortName,helperText:n.shortName,name:"shortName",id:"shortName",margin:"dense",onChange:i,onBlur:r,variant:"outlined",label:"ShortName (*)",fullWidth:!0})}),Object(I.jsx)(g.a,{item:!0,sm:12,children:Object(I.jsx)(w.a,{value:t.displayName,error:n.displayName&&a.displayName,helperText:n.displayName,name:"displayName",id:"displayName",margin:"dense",onChange:i,onBlur:r,variant:"outlined",label:"DisplayName (*)",fullWidth:!0})}),Object(I.jsxs)(g.a,{item:!0,children:[Object(I.jsx)("input",{onChange:function(e){return G(e,"logo")},accept:"image/*",style:{display:"none"},id:"logo-file",multiple:!0,type:"file"}),Object(I.jsx)("label",{htmlFor:"logo-file",children:Object(I.jsx)(y.a,{variant:"contained",color:"primary",disableElevation:!0,component:"span",children:"Upload Logo"})})]}),Object(I.jsxs)(g.a,{item:!0,children:[Object(I.jsx)("input",{onChange:function(e){return G(e,"bgImage")},accept:"image/*",style:{display:"none"},id:"bg-file",multiple:!0,type:"file"}),Object(I.jsx)("label",{htmlFor:"bg-file",children:Object(I.jsx)(y.a,{variant:"contained",color:"primary",disableElevation:!0,component:"span",children:"Upload Background Image"})})]}),Object(I.jsx)(g.a,{item:!0,sm:12,children:Object(I.jsx)(w.a,{label:"Description",variant:"outlined",margin:"dense",multiline:!0,fullWidth:!0})})]}),Object(I.jsxs)(g.a,{container:!0,spacing:2,children:[Object(I.jsx)(g.a,{item:!0,sm:6,children:Object(I.jsx)(x.a,{variant:"button",color:"initial",children:"Area geogr\xe1fica"})}),Object(I.jsx)(g.a,{item:!0,sm:6,style:{textAlign:"right"},children:Object(I.jsxs)("label",{htmlFor:"upload-photo",children:[Object(I.jsx)("input",{onChange:me,style:{display:"none"},id:"upload-photo",name:"upload-photo",type:"file"}),Object(I.jsx)(y.a,{color:"primary",variant:"contained",disableElevation:!0,component:"span",children:"Carregar"})]})}),Object(I.jsx)(g.a,{item:!0,sm:12,children:Object(I.jsx)(f.a,{variant:"outlined",style:{minHeight:"450px"},children:C?Object(I.jsx)(A.c,{libraries:["drawing","places"],id:"script-loader",children:Object(I.jsxs)(A.b,{id:"example-map",mapContainerStyle:W,draggable:!0,zoom:13,center:U,children:[Object(I.jsx)(A.f,{onLoad:pe,paths:X,options:R}),Object(I.jsx)(A.a,{drawingMode:"polygon",options:{drawingControl:!0,drawingControlOptions:{drawingModes:["polygon"]},polygonOptions:{fillColor:"#2196F3",strokeColor:"#2196F3",fillOpacity:.5,strokeWeight:2,clickable:!0,editable:!0,draggable:!0,zIndex:1}},onPolygonComplete:function(e){var t=e.getPath().getArray().map((function(e){return{lat:e.lat(),lng:e.lng()}}));s("coordinates",t),he((function(e){return Object.assign({},e,{drawingMode:"maker"})}))}})]})}):Object(I.jsx)(v.a,{style:{textAlign:"center",marginTop:"220px"},children:Object(I.jsx)(N.a,{})})})}),Object(I.jsx)(g.a,{item:!0,sm:12,children:Object(I.jsx)(_.a,{onChange:function(e,t){V.push(t);var a=new Set(V);V=Array.from(a),ne(!ae)},getOptionLabel:function(e){return e.username},fullWidth:!0,id:"utilizadores",size:"small",options:D,style:{minWidth:200},renderInput:function(e){return Object(I.jsx)(w.a,Object(c.a)(Object(c.a)({variant:"outlined",margin:"dense",fullWidth:!0},e),{},{label:"Adicione utilizadores"}))}})}),Object(I.jsx)(g.a,{item:!0,sm:12,children:Object(I.jsx)(j.a,{component:f.a,children:Object(I.jsxs)(b.a,{size:"small",children:[Object(I.jsx)(u.a,{children:Object(I.jsxs)(h.a,{children:[Object(I.jsx)(m.a,{children:"Username"}),Object(I.jsx)(m.a,{children:"Name"}),Object(I.jsx)(m.a,{children:"Email"}),Object(I.jsx)(m.a,{})]})}),Object(I.jsx)(p.a,{children:V.map((function(e,t){return Object(I.jsxs)(h.a,{children:[Object(I.jsx)(m.a,{component:"th",scope:"row",children:e.username}),Object(I.jsx)(m.a,{children:e.first_name+" "+e.last_name}),Object(I.jsx)(m.a,{children:e.email}),Object(I.jsx)(m.a,{align:"right",children:Object(I.jsx)(k.a,{onClick:function(){V=V.filter((function(e,a){return a!==t})),ne(!ae)},size:"small",children:Object(I.jsx)(S.a,{})})})]},t)}))})]})})}),Object(I.jsx)(g.a,{item:!0,sm:12,style:{textAlign:"right"},children:Object(I.jsx)(y.a,{color:"primary",disableElevation:!0,type:"submit",variant:"contained",children:"Save"})})]})]})}})})})}},760:function(e,t,a){e.exports={container:"instituicoes_container__hG95x",h6:"instituicoes_h6__RpaE2",sticky:"instituicoes_sticky__2X5OQ",stickyInner:"instituicoes_stickyInner__3E8k7",fab:"instituicoes_fab__1AOga"}}}]);